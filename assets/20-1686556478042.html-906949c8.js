import{_ as p,r as i,o as l,c,d as a,e as n,b as t,f as s}from"./app-19e0b0f0.js";const o={},d=s(`<h1 id="springboot环境整合" tabindex="-1"><a class="header-anchor" href="#springboot环境整合" aria-hidden="true">#</a> SpringBoot环境整合</h1><h2 id="引入pom依赖" tabindex="-1"><a class="header-anchor" href="#引入pom依赖" aria-hidden="true">#</a> 引入Pom依赖</h2><p>如果要在您的项目中引入 Sentinel，使用 group ID 为 <code>com.alibaba.cloud</code> 和 artifact ID 为 <code>spring-cloud-starter-alibaba-sentinel</code> 的 starter。</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.alibaba.cloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-cloud-starter-alibaba-sentinel<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="hint-container info"><p class="hint-container-title">注意</p><p>如果项目中未引入Spring Cloud Alibaba相关配置，请先在 <code>dependencyManagement</code> 中添加如下配置。</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependencyManagement</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependencies</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.alibaba.cloud<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-cloud-alibaba-dependencies<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>2.1.0.RELEASE<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>scope</span><span class="token punctuation">&gt;</span></span>import<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>scope</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>type</span><span class="token punctuation">&gt;</span></span>pom<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>type</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependencies</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependencyManagement</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div><h2 id="sentinel-控制台" tabindex="-1"><a class="header-anchor" href="#sentinel-控制台" aria-hidden="true">#</a> Sentinel 控制台</h2><p>Sentinel控制台提供一个轻量级的控制台，它提供机器发现、单机资源实时监控、集群资源汇总，以及规则管理的功能。您只需要对应用进行简单的配置，就可以使用这些功能。</p><p><strong>注意</strong>: 集群资源汇总仅支持 500 台以下的应用集群，有大概 1 - 2 秒的延时。</p><figure><img src="https://jihulab.com/byzh123/images/-/raw/images/pictures/2023/06/13_14_29_25_13_14_29_17_50678855-aa6e9700-103b-11e9-83de-2a33e580325f.png" alt="" tabindex="0" loading="lazy"><figcaption></figcaption></figure><h3 id="获取控制台" tabindex="-1"><a class="header-anchor" href="#获取控制台" aria-hidden="true">#</a> 获取控制台</h3>`,10),r={href:"https://github.com/alibaba/Sentinel/releases",target:"_blank",rel:"noopener noreferrer"},u=s(`<p>我的是1.6.3版本</p><figure><img src="https://jihulab.com/byzh123/images/-/raw/images/pictures/2023/06/13_14_30_37_image-20230613143037387.png" alt="image-20230613143037387" tabindex="0" loading="lazy"><figcaption>image-20230613143037387</figcaption></figure><h3 id="启动控制台" tabindex="-1"><a class="header-anchor" href="#启动控制台" aria-hidden="true">#</a> 启动控制台</h3><p>Sentinel 控制台是一个标准的 Spring Boot 应用，以 Spring Boot 的方式运行 jar 包即可。</p><p>Sentinel默认8080端口启动。如若8080端口冲突，可使用 <code>--server.port=新端口</code> 进行设置。</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">java</span> <span class="token parameter variable">-jar</span> sentinel-dashboard-1.6.3.jar <span class="token parameter variable">--server.port</span><span class="token operator">=</span><span class="token number">8333</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><figure><img src="https://jihulab.com/byzh123/images/-/raw/images/pictures/2023/06/13_14_36_28_image-20230613143628578.png" alt="image-20230613143628578" tabindex="0" loading="lazy"><figcaption>image-20230613143628578</figcaption></figure><h3 id="浏览器访问" tabindex="-1"><a class="header-anchor" href="#浏览器访问" aria-hidden="true">#</a> 浏览器访问</h3>`,8),g={href:"http://localhost:8333",target:"_blank",rel:"noopener noreferrer"},k=s(`<p>默认用户名和密码均为<code>sentinel</code>,登录即可</p><div class="hint-container warning"><p class="hint-container-title">注意:</p><p>首次登录，页面可能为空白状态，这是因为Sentinel为懒加载模式，只有监控到对应的请求后，才会有数据展现</p></div><figure><img src="https://jihulab.com/byzh123/images/-/raw/images/pictures/2023/06/13_14_38_32_image-20230613143832648.png" alt="image-20230613143832648" tabindex="0" loading="lazy"><figcaption>image-20230613143832648</figcaption></figure><h3 id="配置控制台" tabindex="-1"><a class="header-anchor" href="#配置控制台" aria-hidden="true">#</a> 配置控制台</h3><p>修改application.yml文件，增加如下配置：</p><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code><span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">cloud</span><span class="token punctuation">:</span>
    <span class="token key atrule">sentinel</span><span class="token punctuation">:</span>
      <span class="token key atrule">transport</span><span class="token punctuation">:</span>
      	<span class="token comment"># Sentinel与服务之间通信的接口</span>
        <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">8719</span>
        <span class="token comment"># Sentinel控制台地址</span>
        <span class="token key atrule">dashboard</span><span class="token punctuation">:</span> localhost<span class="token punctuation">:</span><span class="token number">8333</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>这里的 <code>spring.cloud.sentinel.transport.port</code> 端口配置会在应用对应的机器上启动一个 Http Server，该 Server 会与 Sentinel 控制台做交互。比如 Sentinel 控制台添加了一个限流规则，会把规则数据 push 给这个 Http Server 接收，Http Server 再将规则注册到 Sentinel 中。</p><h3 id="endpoint-支持" tabindex="-1"><a class="header-anchor" href="#endpoint-支持" aria-hidden="true">#</a> Endpoint 支持</h3><p>Sentinel Endpoint 里暴露的信息非常有用。包括当前应用的所有规则信息、日志目录、当前实例的 IP，Sentinel Dashboard 地址，Block Page，应用与 Sentinel Dashboard 的心跳频率等等信息。</p><p>在使用 Endpoint 特性之前需要在 Maven 中添加 <code>spring-boot-starter-actuator</code> 依赖</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-actuator<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>并在配置中允许 Endpoints 的访问。</p><ul><li>Spring Boot 1.x 中添加配置 <code>management.security.enabled=false</code>。暴露的 endpoint 路径为 <code>/sentinel</code></li><li>Spring Boot 2.x 中添加配置 <code>management.endpoints.web.exposure.include=*</code>。暴露的 endpoint 路径为 <code>/actuator/sentinel</code></li></ul><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code><span class="token comment"># 配置Endpoint信息</span>
<span class="token key atrule">management</span><span class="token punctuation">:</span>
  <span class="token key atrule">endpoints</span><span class="token punctuation">:</span>
    <span class="token key atrule">web</span><span class="token punctuation">:</span>
      <span class="token key atrule">exposure</span><span class="token punctuation">:</span>
        <span class="token key atrule">include</span><span class="token punctuation">:</span> <span class="token string">&#39;*&#39;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="请求测试" tabindex="-1"><a class="header-anchor" href="#请求测试" aria-hidden="true">#</a> 请求测试</h2><p>在浏览器中访问项目中的某个请求后，在Sentinel控制台查看监控情况如下</p><figure><img src="https://jihulab.com/byzh123/images/-/raw/images/pictures/2023/06/13_15_28_27_image-20230613152827331.png" alt="image-20230613152827331" tabindex="0" loading="lazy"><figcaption>image-20230613152827331</figcaption></figure>`,17);function m(v,b){const e=i("ExternalLinkIcon");return l(),c("div",null,[d,a("p",null,[n("根据你项目中依赖的Sentinel版本，您可以从 "),a("a",r,[n("release 页面"),t(e)]),n(" 下载最新版本的控制台 jar 包。")]),u,a("p",null,[n("浏览器访问 "),a("a",g,[n("http://localhost:8333"),t(e)]),n(" 进入Sentinel控制台界面")]),k])}const f=p(o,[["render",m],["__file","20-1686556478042.html.vue"]]);export{f as default};
